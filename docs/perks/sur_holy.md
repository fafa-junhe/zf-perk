# 幸存者职业: 牧师 (Holy)

## 描述

**简短描述:**
> 牧师(Holy)——蹲着治疗幸存者

**详细描述:**
> 你的攻击力降低. 
> 当蹲下不动时,你可以治疗自己和周围的幸存者. 
> 
> “圣光赐予我胜利!” 
> 推荐职业: 缺少医生的队伍

## 参数

| 参数名 | 值 | 描述 |
| --- | --- | --- |
| `ZF_PERK_HOLY` | 7 | Perk的ID |
| `ZF_HOLY_ATTACK` | -25 | 攻击力惩罚 (-25%) |
| `ZF_HOLY_RADIUSSQ` | 400*400 | 治疗光环的半径（平方） |
| `ZF_HOLY_REGEN` | 10 | 每秒为范围内的幸存者恢复的生命值 |

## 核心逻辑

1.  **永久属性修改**:
    *   在 `perk_OnPlayerSpawn` (通过 `updateClientPermStats` 间接调用) 中，如果玩家选择了牧师职业，会应用 `ZF_HOLY_ATTACK` 的攻击力惩罚。但是，代码中 `updateClientPermStats` 函数并没有为牧师添加这个永久惩罚，这可能是一个BUG或者被遗漏的实现。根据代码注释和职业描述，这里应该是有一个攻击力惩罚的。

2.  **治疗光环**:
    *   在 `updateCondStats` 函数中，每秒检查牧师玩家的状态。
    *   **条件检查**:
        *   玩家必须在地面上 (`isGrounded`)。
        *   玩家必须处于蹲伏状态 (`isCrouching`)。
        *   玩家必须没有移动 (`isNotMoving`)。
    *   **治疗效果**:
        *   如果满足所有条件，治疗光环被激活。
        *   光环会对自身以及在 `ZF_HOLY_RADIUSSQ` 范围内的所有其他幸存者，每秒恢复 `ZF_HOLY_REGEN` (10) 点生命值。
        *   同时，会显示一个 `ZFPART_AURAGLOWBEAMS` 的光环特效。
    *   如果不满足条件，光环特效会被隐藏。

## 事件处理

*   **`updateClientPermEffects`**: 在玩家重生时，为牧师玩家创建一个 `ZFPART_AURAGLOWBEAMS` 的光环特效实体，但默认是隐藏的。
*   **`updateCondStats`**:
    *   核心的治疗逻辑所在地。
    *   根据玩家是否“蹲下不动”来决定是否激活治疗光环并显示/隐藏特效。
    *   对范围内的所有幸存者（包括自己）进行治疗。
