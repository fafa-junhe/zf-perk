# 幸存者职业：陷阱大师 (Trapper)

## 介绍

**名称**: 陷阱大师 (Trapper)

**简短描述**:
> 陷阱大师(Trapper)——放置地雷

**详细描述**:
> 发医生语音来放置地雷,僵尸碰到后会自动爆炸,同时最多拥有5个地雷.
> 冷却时间20秒.
>
> “EDD Mounted, let them come.”
> 推荐职业: 任何

## 参数

| 参数名                 | 默认值 | 备注                                                       |
| ---------------------- | ------ | ---------------------------------------------------------- |
| `ZF_TRAPPER_MAX_ITEMS` | 5      | 最多可以同时存在的地雷数量                                 |
| `ZF_TRAPPER_DAMAGE`    | 200    | 地雷造成的伤害                                             |
| `ZF_TRAPPER_RADIUS`    | 150    | 地雷触发和造成伤害的半径                                   |
| `ZF_TRAPPER_RADIUSSQ`  | 40000  | 地雷触发和造成伤害的半径（平方值, 200\*200），代码中实际用于检测 |
| `ZF_TRAPPER_TIMER`     | 20     | 放置地雷的冷却时间（秒）                                   |

## 逻辑处理

### `perk_OnCallForMedic`

-   当拥有此职业的幸存者按下“医生”语音键时：
    -   检查冷却时间 (`zf_perkTimer`) 是否为0。
    -   检查玩家是否在地面上、处于蹲伏状态。
    -   检查当前地雷数量是否已达到 `ZF_TRAPPER_MAX_ITEMS` (5) 的上限。
    -   如果满足条件，则在玩家位置放置一个地雷模型 (`ZFMDL_MINE`)。
    -   设置 `ZF_TRAPPER_TIMER` (20) 秒的冷却时间。

### `updateCondStats`

-   **地雷检测与引爆**:
    -   周期性检查每个已放置的地雷。
    -   检测 `ZF_TRAPPER_RADIUSSQ` (40000) 范围内是否有僵尸。
    -   **引爆**: 如果有僵尸进入范围，并且该僵尸不是“磁化僵尸”，地雷会引爆：
        -   点燃目标僵尸。
        -   在 `ZF_TRAPPER_RADIUS` (150) 半径内造成 `ZF_TRAPPER_DAMAGE` (200) 点范围伤害。
        -   触发大型爆炸视觉效果 (`fxExplosionBig`)。
        -   地雷被消耗并移除。
    -   **失效**: 如果有“磁化僵尸”进入范围，地雷会暂时失效，并产生火花效果 (`fxSpark`)。
    -   **待机**: 如果没有僵尸在附近，地雷会发出“滴答”声 (`ZFSND_TICK`)。
-   **计时器与HUD**:
    -   管理放置地雷的冷却时间，并在HUD上显示是否准备就绪。